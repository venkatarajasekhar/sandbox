Q: What is a cookie?
A cookie is a small piece of data (<<4kb) stored in the browser for a website
A cookie is generated by a server and sent in a HTTP answer to the client
The cookie is stored in a file on the machine the browser runs.


A cookie is attached to a domain (www.example.com)
Only that website will see the cookies attached to this domain (otherwise security issue!) 
A domain can have up to 20 cookies
Each time the browser connect to this domain, all the cookies are sent.

Q: What are cookies good for?
Storing login information (very common!)
Storing small amounts of data to avoid hitting the database all the time
Tracking you for ads!

Q: What are cookies not good for?
Storing user preference! 
People log into their account from several machine and/or browser.
Cookie files can be erased at any time

Q: How are cookies set between servers and clients?
Cookies are sent in and controlled from the HTTP headers.
Let's assume that the desired cookie is user_id=12345

A server can tell a client to set a cookie with the header
Set-cookie: user_id=12345                                       <-- Use the Set-cookie header to create a cookie
Set-cookie: name=toto                                           <-- another cookie

In the *next* HTTP request
Cookie: user_id12345;last-seen=Dec 25 1985                      <-- ; used to separate the cookie

!!! Note that a http client cannot set a cookie. Only web server can !!!

Q: How can I send a ; in a cookie header?
Short answer: you can't because ; is used to separate cookie
Long answer: you can, but do a transformation (eg rot13, etc)

Q: Sample real life cookie ?
Set-cookie: PREF=ID=12345;expires=Sat, 19-Apr-2014 23:50:21 GMT; path=/; domain=.google.com; HttpOnly
1/ Value includes a = sign!
2/ expiration date
3/ relevant path in url                     <-- if no specified path. then path=/
4/ relevant domain                          <-- domain must END with .google.com
5/ Only for http requests
!!! 2 to 5 are so that the browser knows when to send a cookie, i.e are not sent back to the server !!!
Cookie: PREF=ID=12345
is what the client sends back to the server at the next request

Q: Any restriction in cookie creation?
A domain must include at least 2 dots (i.e. domain=.com is not valid )
A domain is compared to a website (Host header) and only subdomain are accepted

Q: If this cookie is set  Set-cookie: user=123; domain=ide.udacity.com, to which domain would the client browser  sent it?
~ valid receivers
ide.udacity.com
other.ide.udacity.com 
but not 
udacity.com
other.udacity.com

Q: If we visit a domain, which domain server would be allowed to set this same cookie? 
(Set-cookie: user=123; domain=ide.udacity.com)
~ valid setters (valid domains that can SET this cookie)
ide.udacity.com
other.ide.udacity.com           <-- because is a subdomain
but not 
udacity.com
other.udacity.com

Q: What are 3rd party cookies?
Ex: google analytics?
Ex: advertising
Cookie generated when fetching an embedded image/frame from another website

Q: What is a session cookie?
A session cookie is one that expires when you close the browser
It doesn't have an expire parameter

Q: How does the login 'remember me' works?
Well, by clicking the button, you set the expiration parameter

Q: How to set a cookie from a browser?
In a javascript console (Chrome+), enter: document.cookie
That function returns all the cookies
Set a cookie to whatever value you what (from the client side) with
document.cookie="visits=10000"

Q: How to prevent the above cheat?
Hashing of the cookies!

Q: What is hashing?
H(x) --> y
x: data
y is fixed length bit string 32-256 bits

Q: Properties of hash function?
~ applied cryptography!
- difficult to generate a specific y
- infeasible to find x for a given y ( 1 way function !)
- can't modify x without significantly modifying y

Q: can I write my own hash algorithm?
No! Don't write your own!
crc32 - checksum, fast (but lots of collision)
md5 - fast, but not secure!
sha1 - not as fast, fairly secure
sha256 - relatively slow, but pretty good <-- to be used if not to o much traffic

Q: What is a collision?
Two thing hash to the same value hard to find

Q: What are rainbow tables?
Table with a --> H(a)
to reverse engineer simple hashed value

Q: What is a salt?
a --> H(a + salt + secret ) 
salt changes for each a
but secret stays the same
