#---------------------------------------------------------------------- 
# ACCESS

Q: How to access moinmoin?
ssh -i ~/ssh/moinmoin_awskey.pem ubuntu@moinmoin

#----------------------------------------------------------------------
# INSTALLATION 

Q: How to install on ubuntu?

apt-get install python-moinmoin
cd /usr/share/moin
sudo mkdir mywiki
sudo cp -R data mywiki
sudo cp -R underlay mywiki
sudo cp server/moin.cgi mywiki
sudo chown -R www-data.www-data mywiki
sudo chmod -R ug+rwX mywiki
sudo chmod -R o-rwx mywiki

Master configuration file: /etc/moin/farmconfig.py
Check wikis configuration. The "manuals" entrie points to /etc/moint/manuals.py wiki config file
!!! URL Match determine configuration file to be used on moin.cgi 
!!! moin.cgi is found thanks to script alias config in apache2 config
wikis = [
    ("mucls", r"http://mucls.lynceantech.com/.*"),   
    ("mucls", r"http://mucls/.*"),   
    ("manuals", r"http://manuals.lynceantech.com/.*$"), 
    ("manuals", r"http://manuals/.*$"),   
]

In wiki configuration, i.e /etc/moin/manuals.py, we have
* data_dir = '/usr/share/moin/wikis/manuals/data'
* data_underlay_dir='/usr/share/moin/wikis/manuals/underlay'

apt-get install apache2
vi /etc/apache2/sites-available/default
### moin
  ScriptAlias /wiki "/usr/share/moin/wikis/moin.cgi"        # <-- where to find the script (can be shared between all wikis!)
  alias /moin_static184 "/usr/share/moin/htdocs"
  <Directory /usr/share/moin/htdocs>
  Order allow,deny
  allow from all
  </Directory>
### end moin
sudo /etc/init.d/apache2 restart

Verification:
http://localhost/wiki
http://manuals/wiki
http://manuals.lynceantech.com/wiki

Q: How to add the help and search engine page ?
Got to the LanguageSetup, select your language and click on the download all_page link.
The installation is automatic !
Files are installed in .../wikis/manuals/underlay directory as expected 
!!! FindPage is created in .../wikis/manuals/data/page

#---------------------------------------------------------------------- 
# CONFIGURATION

Q: what are the important files ?
/etc/moin/farmconfig.py  - global configuration files (for all wikis running on this machine )
/etc/moin/<mywiki>.py     - wiki specific configuration file (delta from farmconfig.py)
Note that <mywiki>.py is read because of the wikis list of tuples in farmconfig.py

/usr/share/moin
    - data      :   content of data directory of a virgin wiki
    - underlay  :   static files that can be overwritten based on the content of data
    - server    :   pick the server type (i.e moin.cgi in our case

Q: Configuration parameters?
http://moinmo.in/HelpOnConfiguration#pages

Q: Change logo?
In /etc/moin/mywiki.py
sitename = u'Untiled Wiki'  # Name your wiki
logo_string = u'<img src="/htdocs/common/lynceantech.png" alt="MoinMoin Logo">'
#/usr/share/moin/htdocs/common/lynceantech.png

Q: How to add email capabilities?
In farmconfig.py or <mywiki>.py config file
Check connection to server is ok
telnet smtpauth.earthlink.net 25
in /etc/moin/mywiki.py configuration
mail_from = u'Wiki Notifier <noreply@lynceantech.com>'
mail_login = "lynceantech@earthlink.net yasux72d"
mail_smarthost = "smtpauth.earthlink.net:25"

#---------------------------------------------------------------------- 
# USER ACCOUNTS

Q: Where are user accounts saved?
In the /usr/share/moin/wikis/manuals/data/user directory
In that directory each file represents a user.
In a file are stored all users settings and credentials.
The pasword is hashed with SHA1.
If the password is lost, you can overwrite it manually!

Q: does the admin user have a file in /usr/share/moin/wikis/manuals/data/user too?
Yes!

Q: Are credentials shared between wikis on the same machine?
No! You need to create one account per wiki.

Q: What is the purpose of creating an account?
To authenticate against the ACL.
If there is no ACL for a particular page, everyone can edit it!

Q: How to create a personal page, aka WikiHomePage?
Once logged in, click on your name at the very top of the page.
http://wikifarm/wiki/EmmanuelMayssat
!!! When creating a WikiHomePage, place a link to CategoryHomepage on the bottom of the page. (It is done in the HomePageTemplate)!!!

Q: What are the privileges of superusers?
* bypass ACL
* can switch user

Q: what are logged in accounts?
Once logged in, you can 
    AUTHENTICATION
    * authenticate against acl.
    PREFERENCE
    * receive email notification
    * change the default theme
    USER EXPERIENCE
    * path tracking (Like the back button in the browser, but this time through the application)
    * quicklinks

#----------------------------------------------------------------------
# EDIT HELP

Q: How to add a page?
(1) Go to the non-existing page URL ex: http://wikifarm/wiki/Toto to create the page Toto
(2) On an existing page, create a link to that page ex: /MySibling or MyNewPage

Q: How to delete a page?
Go on the page, click on [Action] and select 'Delete Page'


Q: How to add an image to a wiki page?
Add the page as an attachment to the corresponding page
When editing the page:
{{attachment:image.png}}        <-- inline
[[attachment:image.png]]        <-- link to image


Q: How to link 2 wiki pages together?
Check Linking @ http://moinmo.in/HelpOnLinking
The easiest way is to use a WikiName (CamelCase page name)
FrontPage                                               - automated link (To avoid internal link: !FrontPage)
/Subpage                                                - link to subpage
[[attachment:image.png]]                                - link to attached image from local page
[[attachment:SomePage/image.png]]                       - link to attached image from another wiki page
[[http://example.net/|example site|target="_blank"]]    - external link
[[#anchorname| anchor description]]                     - link to anchor

Q: How to create and link to an anchor?
<<Anchor(anchorname)>> inserts a link anchor anchorname
[[#anchorname| anchor description]] 

Q: How to include raw HTML in a page?
Check MacroMarket at http://moinmo.in/MacroMarket/HTML
[[HTML(<iframe src="http://petrolera.xarxa.net/inscrits.php?classe=N" _fcksavedurl=""http://petrolera.xarxa.net/inscrits.php?classe=N"" width="100%" height="600"></iframe>)]]
<<HTML(<b>bold</b>)>>

Q: How to create a download link for an attachment? (not tested!)
With {{attachment:myfile.png|alias description|&do=get}} you can create a download link to an attachment.

Q: How to create a table of content?
Table of contents (up to 2nd level headings only):
<<TableOfContents(2)>>      <-- 2 is depth of TOC
= heading 1st level =
== heading 2nd level ==
=== heading 3rd level ===
= heading 1st level =
== heading 2nd level ==
=== heading 3rd level ===


Q: How to add comments to a wiki page?
{{{#!wiki comment/dotted
This is a wiki parser section with class "comment dotted" (see HelpOnParsers).

Its visibility gets toggled the same way.
}}}

Q: How to show comments directly without having to click on 'comments' ?

Q: How to add a comment to a page commit?
Before clicking on save, enter a comment on the same page.
Note that comments on that page are checking commments

Q: How to create a table and style the cells?
||<style="background-color:green;">'''CLS On'''||||<style="background-color:blue;">'''CLS Off'''||<style="background-color:red;">'''Install'''||<style="background-color:yellow;">'''Test'''||

Q: Font styling?
'' italics '' 

#----------------------------------------------------------------------
# ACCESS CONTROL RIGHTS (ACL)

Q: Access control right and superuser?
In the /etc/moin/<wiki>.py configuration page, configure a super user as follow:
acl_rights_before = u"EmmanuelMayssat:read,write,delete,revert,admin"
This means that the user EmmanuelMayssat (login) has all the priviledge including admin  on the site (on every page of the site)
That is EmmanuelMayssat cannot be locked out!
!!! Note that the User account needs to exist and be used

Q: How to add ACL to a page?
To add acl to a specific page, when editing the page, you can add 
#acl All:read
and save the page.
Thereafter the page is read only for everyone except the superuser.
!!! The ACL command should be the top-most line on your wiki page
!!! Beware that 'All' start with uppercase A
!!! Attachments are protected by the ACLs of the page they are attached to.

Q: What are the rights?
read    - users will be able to read a page, and download its attachments.
write   - users will be able to edit (write) a page, and upload attachments.
delete  - users will be able to delete a page and it's attachments.
revert  - users will be able to 'revert' a page back to an older revision.
admin   - users will be able to change the "#acl" line on a page, as well as grant and/or revoke "admin" privileges from others.

Q: ACL group?
User    - where User matches a specific username and triggers only if it matches exactly (including case-sensitivity).
SomeGroup - where SomeGroup matches a specific group name, which you define (see HelpOnGroups).
Trusted - a special group containing all authenticated users of a trusted authentication method.
Known   - a special group containing all logged in users.
All     - a special group that means "everyone" (both logged in (i.e. Known) and anonymous users).

Q: Complex page ACL?
#acl [+-]User[,SomeGroup,...]:[right[,right,...]] [[+-]OtherUser:...] [[+-]Trusted:...] [[+-]Known:...] [[+-]All:...] [Default]
!!! +- are filters who add or remove rights but do not stop processing (Additional rights may be granted later)
!!! Default is a special entry which inserts at the given place the entries from acl_rights_default
!!! Normally [Default] is read at the end of the ACL defined on the page

Q: Example of ACL filter?
#acl SomeUser:read,write SomeGroup:read,write,admin All:read
#acl -SomeUser:admin SomeGroup:read,write,admin All:read
are equivalent when SomeUser is in SomeGroup

Q: How does ACL processing work?
The system tries to find the first match for the user and the right.
First look at the configuration parameter
* acl_rights_before            - check configuration file (used for administrators)
* acl defined on the page
* acl_rights_default           - check configuration file (default ACL on every page)
* acl_rights_after             - check configuration file (make sure those rights are not foggotten, i.e. read!)
!!! DEFAULT FOR acl_rights_default = u'Known:read,write,delete,revert All:read,write'

Q: How to create a ACL group?
A group must end with the prefix Group
Create a page called AdminGroup, TrustedGroup, ...
and add an undordered list of users
More @ http://moinmo.in/HelpOnGroups




#---------------------------------------------------------------------- 
# MACROS

Q: what are macros ?
Automated generated content, like a table of content
There are currently 4 types of macros:
- search macros
- navigation macros
- system information macros
- othes

Q: What are examples of macros?
<<Anchor(anchorname)>>                  - inserts a link anchor anchorname
<<BR>>                                  - inserts a hard line break
<<FootNote(Note)>>                      - inserts a footnote saying Note
<<Include(HelpOnMacros/Include)>>       - inserts the contents of the page HelpOnMacros/Include inline
<<MailTo(user AT example DOT com)>>     - obfuscates the email address user@example.com to users not logged in
<<FullSearch(ForEmmanuel -ForName)>>    - list of pages with ForEmmanuel in them
<<FullSearchCached(category:CategoryCategory)>>
<<TableOfContents(2)>>                  - Table of content of depth 2
More @ http://wikifarm/wiki/HelpOnMacros

Q: How to create a macro?

#---------------------------------------------------------------------- 
# TEMPLATE

Q: What are template?
Templates make it easier for users to add new pages. 
Instead of requiring that each bit of new information be added by hand, templates have some text and structure already filled in.
The key is that Variables can be used to insert date, time, creator, pagename, and the like.

Q: How to create template?
A template page is a MoinMoin page which must be named with an ending fitting the standard template name ending 
(which defaults to some non-blank characters followed by "Template")

Q: What are variables?
@PAGE@
@EMAIL@
@DATE@
http://wikifarm/wiki/HelpOnVariables
!!! You can also create your own variables !!!

Q: Who to create your own variables?
Create a wiki page Wiki/EmmanuelMayssat/MyDict
Insert in that page 
 B:: <style="background-color:blue;">               # <-- Don't forget the heading space!
Now every pages with 
|| @B@ ||
will display a blue cell!

Q: How to use a template?
When creating an empty page, you can create an empty page or select a template to use

Q: CategoryTemplate?


#----------------------------------------------------------------------
# USER CUSTOMIZATION

Q: How to setup email notification?
Make sure it is enabled by checking the configuration.

Q: How to change the theme?
Check  

Q: What is a subpage?
/SubPage or [[/sub page]]
It is a page that is created in a subdirectory.
The only particular thing about subpage is how they are accessible 

!!! Several subpage can have the same name (as long as they don't have the same parent !!!

Q: How to (un)subscribe to a page?
2 ways:
(1) Go on the page and hit (un)subscribe
(2) or [Actions] and select (un)subscribe
!!! Beware the page needs to be edited for a notification to be sent
!!! Changes of returned values by a macros (i.e. FullSearch macro) do not sent notifications

Q: Preferences ?
Show top/bottom links in heading        - show arrows in page headers to jump up and down !
Open editor on double click             - double click on page and the editor opens!

Quick links                             - The quick links for this account



#----------------------------------------------------------------------
# NAVIGATION

Q: How to find pages that link to a particlar page?
http://moinmoin/wiki/AnotherPage?action=fullsearch&context=180&value=linkto%3A%22AnotherPage%22
http://moinmoin/wiki/AnotherPage?action=fullsearch&context=180&value=linkto%3A%22AnotherPage%22&fullsearch=Text     <-- search content of articles (and display matching)
http://moinmoin/wiki/AnotherPage?action=fullsearch&context=180&value=linkto%3A%22AnotherPage%22&titlesearch=Titles  <-- search (and display) titles only

If there is only one, then when you click on the Title, it goes to it.
Otherwise, it displays a list of pages and you can select one

Q: What are quicklink?
Creating a quick link for the page means that a tab is created and will stay in the tab bar until the quick link is disabled.
To create a quicklink for AnotherPage:
http://moinmoin/wiki/AnotherPage?action=quicklink
or when on the page click on [add link]

Q: Search engine ?
http://moinmo.in/HelpOnConfiguration#xapian

Q: How to find pages that links to a specific page?
Search: linkto:"MuSchedule"


#----------------------------------------------------------------------
# DOCUMENT CONTROL

Q: How to revert a page to a previous version?
Go to page. Click on Info. Select 2 version to diff.
There is a revert button.

Q: How to delete/rename a page ?
Check the More action button!

Q: How to force people to login to edit a page?
Create an ACL on a template page

Q: What are Category page?
Example of category pages are: CategoryHomePage, CategoryTemplate
A category is a WikiName that exploits WikiWiki's reverse linking: 
If you click on the title of a category page, you'll get a list of pages belonging to that category. 
To get a list of all categories, click the CategoryCategory title in the navigation area.

Q: How to put a page in a category?

